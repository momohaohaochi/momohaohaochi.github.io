---
title: HTTPS
date: '2021-01-31 00:00:00'
tags:
- MSB
- Session Manage
- HTTPS
- Java
---
# HTTPS

## 常用算法介绍

### 对称加密

有一个密钥，使用该密钥可以对数据进行加密和解密

- 加密：明文 + 密钥 = 密文

- 解密：密文 + 密钥 = 明文

### 非对称加密

有两个密钥，公钥和私钥，使用公钥进行加密，私钥进行解密，或者使用私钥进行加密，公钥进行解密

| 加密               | 解密               |
| ------------------ | ------------------ |
| 明文 + 公钥 = 密文 | 密文 + 私钥 = 明文 |
| 明文 + 私钥 = 密文 | 密文 + 公钥 = 明文 |

### 摘要算法

相同的数据经过计算得到的结果是相同的。可以通过该算法生成**数字签名**

## 请求执行流程

![image-20210126154842972](https://gitee.com/swang-harbin/pic-bed/raw/master/images/2021/20210126154843.png)

客户端向服务端发送 http 请求，会经过多个路由器等设备，只要在其中一个节点拦截到交互的数据包，即可获取到数据包的内容。

### 为什么不能使用对称加密

对称加密有一个密钥，服务端要把密钥发送给客户端，这样双方才能进行后续的通信。此时如果密钥被截取了，中间方就可以对双方传输的数据包进行操作。

### 为什么不能使用非对称机密

非对称加密包含两个密钥，服务器要把公钥发送给客户端，这样双方才能进行后续的通信。此时如果公钥被截取了，中间方就可以伪造一组公钥和私钥，然后将伪造的公钥发送给客户端，从而在中间对传输的数据进行修改。

## HTTS 如何解决密钥泄漏问题

HTTPS 的全称是 HTTP over SSL，简单理解就是在 HTTP 传输的基础上增加了 SSL 协议的加密能力。

### SSL 证书

由受信任的数字证书颁发机构（CA）在验证服务器身份后颁发的，与服务器域名是进行绑定的，并通过私钥进行加密（私钥仅保存在 CA 机构，不会外漏）。知名可信的 CA 机构证书信息，在操作系统中默认都是有保存的，浏览器用其来对服务器发过来的证书进行校验。

### 加入 SSL 证书后的请求流程

![image-20210126192522091](https://gitee.com/swang-harbin/pic-bed/raw/master/images/2021/20210126192522.png)

1. Client Hello：浏览器访问服务器，告诉服务器它的 SSL 版本和支持的加密算法
2. Server Hello：服务器接收到请求后，选择出一种加密算法，告诉浏览器
3. 服务器把自己的 SSL 证书发送给浏览器，SSL 证书中包含服务器的公钥等信息
4. 浏览器对该 SSL 证书进行验证，并从中获取到服务器的公钥。然后生成一个密钥使用服务器公钥进行加密后发送给服务器
5. 服务器使用私钥对密文解密，获取到浏览器生成的密钥
6. 之后浏览器和服务器间通过之前约定好的对称加密算法，以及浏览器生成的密钥对数据进行加密传输

第 3 步时，如果中间有黑客，它可以获取到服务器发送的 SSL 证书，也可以对 SSL 证书进行解密（因为 SSL 证书本来就是公开的），获取到服务器的公钥。但是其无法将 SSL 证书中的公钥进行替换后并重新生成伪造的 SSL 证书，因为 SSL 证书的签名是根据服务器公钥以及证书私钥生成的，如果其将服务器公钥替换，那么证书的签名就不匹配了，在第 4 步校验 SSL 证书的时候，就会出现错误。

https://ke.qq.com/webcourse/398381/101809137#taid=7879177634452525&vid=5285890804089720211

